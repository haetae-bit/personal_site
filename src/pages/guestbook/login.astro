---
export const prerender = false;

import bcrypt from "bcryptjs";

if (Astro.request.method === "POST") {
  const form = await Astro.request.formData();
  const pwd = form.get("password");

  if (pwd) {
    const hashed = bcrypt.hashSync(pwd.toString(), 10);
    Astro.session?.set("pwd", hashed);
    return Astro.redirect("/guestbook/admin");
  }
}
---
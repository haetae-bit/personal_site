---
import dayjs from "dayjs";
import utc from "dayjs/plugin/utc";
import Layout from "./Layout.astro";

interface Props {
  title: string;
  ficTitle: string;
  date: Date;
  notes?: string;
  lastModified?: Date;
}

const { title, ficTitle, date, notes, lastModified }: Props = Astro.props;
dayjs.extend(utc);
---
<Layout title={`${ficTitle}, ${title}`}>
  <slot name="breadcrumbs" />

  <main>
    <header>
      <h1>{title}</h1>
      <time datetime={dayjs(date).utc(true).toISOString()}>
        Published on {dayjs(date).utc(true).format("MMMM DD, YYYY")}
      </time>
      {lastModified && (
        <time datetime={dayjs(lastModified).utc(true).toISOString()}>
          Last edited on {dayjs(lastModified).utc(true).format("MMMM DD, YYYY")}
        </time>
      )}
      {notes && (
        <blockquote>
          <Fragment set:html={notes} />
        </blockquote>
      )}
    </header>

    <article>
      <slot />
    </article>

    <slot name="pagination" />
  </main>
</Layout>

<style>
  main {
    display: grid;
    place-content: center;
    margin: 1rem auto 2rem;

    @media screen and (max-width: 1000px) {
      margin: 1rem 1rem 2rem;
    }
  }
  
  article, blockquote {
    max-width: 80ch;
    font-family: var(--serif-font);
  }

  header {
    blockquote {
      margin: 1rem;
      font-size: calc(35px / 2);

      &::before {
        display: block;
        content: "Authorâ€™s Notes:";
        font-weight: bold;
        line-height: 1;
        alt: "Author's Notes:";
      }
    }

    @media screen and (max-width: 800px) {
      time { font-size: calc(1rem - 1px); }
    }
  }

  article {
    margin: 1rem 0;
    font-size: 1.25rem;
    line-height: 1.75;
    margin-trim: block;

    p { margin-block: 1lh; }
    @supports not (margin-trim: block) {
      :first-child { margin-block-start: 0; }
      :last-child { margin-block-end: 0; }
    }
  }
</style>